<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper  
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lyra.db.mybatis.MetaMapper">
	<resultMap type="Meta" id="metaObject">
		<id column="K_ID" property="uniqueId"/>
		<result column="C_OOBDATA_FILE" property="oobFile"/>
		<result column="C_IN_USE" property="using"/>
		<result column="C_INIT_ORDER" property="initOrder"/>
		<result column="C_INIT_SUBORDER" property="initSubOrder"/>
		
		<result column="S_NAME" property="name"/>
		<result column="S_NAMESPACE" property="namespace"/>
		<result column="S_CATEGORY" property="category" typeHandler="org.apache.ibatis.type.EnumTypeHandler"/>
		<result column="S_GLOBAL_ID" property="globalId"/>
		<result column="S_MAPPING" property="mapping" typeHandler="org.apache.ibatis.type.EnumTypeHandler"/>
		<result column="S_POLICY" property="policy" typeHandler="org.apache.ibatis.type.EnumTypeHandler"/>
		
		<result column="D_TABLE" property="table"/>
		<result column="D_SUB_TABLE" property="subTable"/>
		<result column="D_SUB_KEY" property="subKey"/>
		<result column="D_SEQ_NAME" property="seqName"/>
		<result column="D_SEQ_STEP" property="seqStep"/>
		<result column="D_SEQ_INIT" property="seqInit"/>
	</resultMap>
	<insert id="insertMeta" parameterType="Meta" keyColumn="K_ID" keyProperty="uniqueId">
		INSERT INTO SYS_META (
			K_ID,
			C_OOBDATA_FILE,
			C_IN_USE,
			C_INIT_ORDER,
			C_INIT_SUBORDER,
			S_NAME,
			S_NAMESPACE,
			S_CATEGORY,
			S_GLOBAL_ID,
			S_MAPPING,
			S_POLICY,
			D_TABLE,
			D_SUB_TABLE,
			D_SUB_KEY,
			D_SEQ_NAME,
			D_SEQ_STEP,
			D_SEQ_INIT
		) VALUES (
			#{uniqueId},
			#{oobFile},
			#{using},
			#{initOrder},
			#{initSubOrder},
			#{name},
			#{namespace},
			#{category, typeHandler=org.apache.ibatis.type.EnumTypeHandler}
			#{globalId},
			#{mapping, typeHandler=org.apache.ibatis.type.EnumTypeHandler},
			#{policy, typeHandler=org.apache.ibatis.type.EnumTypeHandler},
			#{table},
			#{subtable},
			#{subkey},
			#{seqName},
			#{seqStep},
			#{seqInit}
		)
	</insert>
	<update id="updateMeta" parameterType="Meta" keyColumn="K_ID" keyProperty="uniqueId">
		UPDATE SYS_META SET
			C_OOBDATA_FILE=#{oobFile},
			C_IN_USE=#{using},
			C_INIT_ORDER=#{initOrder},
			C_INIT_SUBORDER=#{initSubOrder},
			S_NAME=#{name},
			S_NAMESPACE=#{namespace},
			S_CATEGORY=#{category, typeHandler=org.apache.ibatis.type.EnumTypeHandler},
			S_GLOBAL_ID=#{globalId},
			S_MAPPING=#{mapping, typeHandler=org.apache.ibatis.type.EnumTypeHandler},
			S_POLICY=#{policy, typeHandler=org.apache.ibatis.type.EnumTypeHandler},
			D_TABLE=#{table},
			D_SUB_TABLE=#{subtable},
			D_SUB_KEY=#{subkey},
			D_SEQ_NAME=#{seqName},
			D_SEQ_STEP=#{seqStep},
			D_SEQ_INIT=#{seqInit}
		WHERE K_ID=#{uniqueId}
	</update>
	<delete id="deleteById" parameterType="String">
		DELETE FROM SYS_META WHERE K_ID=#{uniqueId}
	</delete>
	<delete id="deleteByModel">
		DELETE FROM SYS_META WHERE NAME=#{name,jdbcType=VARCHAR} AND NAMESPACE=#{namespace,jdbcType=VARCHAR}
	</delete>
	<select id="selectById" parameterType="String" resultMap="metaObject">
		SELECT * FROM SYS_META WHERE K_ID=#{uniqueId}
	</select>
	<select id="selectByModel" resultMap="metaObject">
		SELECT * FROM SYS_META WHERE NAME=#{name,jdbcType=VARCHAR} AND NAMESPACE=#{namespace,jdbcType=VARCHAR}
	</select>
</mapper>